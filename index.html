// --- フォーム送信処理内の成功時の処理を変更 ---
async function handleFormSubmit(event) {
    // 既存のコード...
    
    if (result.success) {
        console.log("送信成功:", result);
        
        // フォームを非表示にして完了メッセージを表示
        const container = document.querySelector('.container');
        
        // 送信前のコンテンツを保存（戻るボタン用）
        const originalContent = container.innerHTML;
        
        // 完了メッセージに置き換え
        container.innerHTML = `
            <div style="text-align: center; padding: 20px;">
                <div style="color: #06c755; font-size: 60px; margin: 20px 0;">✓</div>
                <h1 style="color: #06c755; font-size: 24px; margin-bottom: 20px;">送信完了</h1>
                <p style="font-size: 16px; line-height: 1.6; color: #333; margin-bottom: 20px;">お問い合わせありがとうございました。<br>内容を確認の上、担当者より連絡させていただきます。</p>
                <p style="font-size: 16px; line-height: 1.6; color: #333; margin-bottom: 20px;">このページは閉じて大丈夫です。</p>
                <button id="closeButton" style="background-color: #6c757d; color: white; border: none; border-radius: 4px; padding: 10px 20px; font-size: 16px; cursor: pointer; margin-right: 10px;">ウィンドウを閉じる</button>
                <button id="backButton" style="background-color: #007bff; color: white; border: none; border-radius: 4px; padding: 10px 20px; font-size: 16px; cursor: pointer;">新しい見積もりを作成</button>
            </div>
        `;
        
        // 閉じるボタンの処理
        document.getElementById('closeButton').addEventListener('click', function() {
            if (liff.isInClient()) { 
                liff.closeWindow(); 
            } else { 
                alert('このウィンドウを閉じてください。'); 
            }
        });
        
        // 戻るボタンの処理（フォームをリセット）
        document.getElementById('backButton').addEventListener('click', function() {
            container.innerHTML = originalContent;
            // 必要なイベントリスナーを再度バインド
            bindEventListeners();
            addItemRow();
            setInitialDate();
        });
        
        // 3秒後に自動的に閉じる（LIFF内の場合のみ）
        setTimeout(() => { 
            if (liff.isInClient()) { 
                liff.closeWindow(); 
            } 
        }, 5000);
    } else {
        // エラー処理（既存のコード）
    }
    
    // 既存のコード...
}
